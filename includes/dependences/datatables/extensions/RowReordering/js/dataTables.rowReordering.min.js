(function(e){"use strict";e.fn.rowReordering=function(t){function n(t){if(t.fnSettings().oFeatures.bProcessing){e(".dataTables_processing").css("visibility","visible")}}function r(t){if(t.fnSettings().oFeatures.bProcessing){e(".dataTables_processing").css("visibility","hidden")}}function i(t,n){var r=1e6;e(n,t).each(function(){iPosition=parseInt(t.fnGetData(this,l.iIndexColumn));if(iPosition<r)r=iPosition});return r}function s(e,t,n,r,i){t.sortable("cancel");if(r<=n.iLogLevel){if(i!=undefined){n.fnAlert(i,"")}else{n.fnAlert("Row cannot be moved","")}}n.fnEndProcessingMode(e)}function o(t,n,r){var i=e("#"+r,t);var s=t.fnGetData(i[0],l.iIndexColumn);var o=-1;var u;var a=i.prev(n);if(a.length>0){o=parseInt(t.fnGetData(a[0],l.iIndexColumn));if(o<s){o=o+1}}else{var f=i.next(n);if(f.length>0){o=parseInt(t.fnGetData(f[0],l.iIndexColumn));if(o>s)o=o-1}}if(o<s)u="back";else u="forward";return{sDirection:u,iCurrentPosition:s,iNewPosition:o}}function u(t,n,r,i,s,o,u){var a=r;var f=i;if(s=="back"){a=i;f=r}e(t.fnGetNodes()).each(function(){if(u!=""&&e(this).attr("data-group")!=u)return;var n=this;var r=parseInt(t.fnGetData(n,l.iIndexColumn));if(a<=r&&r<=f){if(n.id==o){t.fnUpdate(i,t.fnGetPosition(n),l.iIndexColumn,false,false)}else{if(s=="back"){t.fnUpdate(r+1,t.fnGetPosition(n),l.iIndexColumn,false,false)}else{t.fnUpdate(r-1,t.fnGetPosition(n),l.iIndexColumn,false,false)}}}});var c=t.fnSettings();if(c.oFeatures.bServerSide===false){var h=c._iDisplayStart;c.oApi._fnReDraw(c);c._iDisplayStart=h;c.oApi._fnCalculateEnd(c)}c.oApi._fnDraw(c)}function a(e,t){alert(e)}var f={iIndexColumn:0,iStartPosition:1,sURL:null,sRequestType:"POST",iGroupingLevel:0,fnAlert:a,fnSuccess:jQuery.noop,iLogLevel:1,sDataGroupAttribute:"data-group",fnStartProcessingMode:n,fnEndProcessingMode:r,fnUpdateAjaxRequest:jQuery.noop};var l=e.extend(f,t);var c,h;var p=function(t,n){var r=n.children();var i=n.clone();i.children().each(function(t){e(this).width(r.eq(t).width())});return i};return this.each(function(){var t=e(this).dataTable();var n=t.fnSettings().aaSortingFixed==null?new Array:t.fnSettings().aaSortingFixed;n.push([l.iIndexColumn,"asc"]);t.fnSettings().aaSortingFixed=n;for(var r=0;r<t.fnSettings().aoColumns.length;r++){t.fnSettings().aoColumns[r].bSortable=false}t.fnDraw();e("tbody",t).disableSelection().sortable({cursor:"move",helper:p,update:function(n,r){var i=t;var a=e(this);var f="tbody tr";var c="";if(l.bGroupingUsed){c=e(r.item).attr(l.sDataGroupAttribute);if(c==null||c==undefined){s(i,a,l,3,"Grouping row cannot be moved");return}f="tbody tr["+l.sDataGroupAttribute+" ='"+c+"']"}var h=o(i,f,r.item.context.id);if(h.iNewPosition==-1){s(i,a,l,2);return}if(l.sURL!=null){l.fnStartProcessingMode(i);var p={url:l.sURL,type:l.sRequestType,data:{id:r.item.context.id,fromPosition:h.iCurrentPosition,toPosition:h.iNewPosition,direction:h.sDirection,group:c},success:function(e){l.fnSuccess(e);u(i,f,h.iCurrentPosition,h.iNewPosition,h.sDirection,r.item.context.id,c);l.fnEndProcessingMode(i)},error:function(e){s(i,a,l,1,e.statusText)}};l.fnUpdateAjaxRequest(p,l,i);e.ajax(p)}else{u(i,f,h.iCurrentPosition,h.iNewPosition,h.sDirection,r.item.context.id,c)}}})})}})(jQuery)